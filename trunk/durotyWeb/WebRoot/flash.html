<HTML>
	<HEAD>
		<TITLE>Flash Interaction with JavaScript</TITLE>
		<link rel="stylesheet" type="text/css" href="../../style/main.css">

		<script language="JavaScript">
<!--
// F. Permadi May 2000
function getFlashMovieObject(movieName)
{
  if (window.document[movieName]) 
  {
    return window.document[movieName];
  }
  if (navigator.appName.indexOf("Microsoft Internet")==-1)
  {
    if (document.embeds && document.embeds[movieName])
      return document.embeds[movieName]; 
  }
  else // if (navigator.appName.indexOf("Microsoft Internet")!=-1)
  {
    return document.getElementById(movieName);
  }
}

function StopFlashMovie()
{
	var flashMovie=getFlashMovieObject("myFlashMovie");
	flashMovie.StopPlay();
}

function PlayFlashMovie()
{
	var flashMovie=getFlashMovieObject("myFlashMovie");
	flashMovie.Play()
	//embed.nativeProperty.anotherNativeMethod();
}

function RewindFlashMovie()
{
	var flashMovie=getFlashMovieObject("myFlashMovie");
	flashMovie.Rewind();
}

function NextFrameFlashMovie()
{
	var flashMovie=getFlashMovieObject("myFlashMovie");
	// 4 is the index of the property for _currentFrame
	var currentFrame=flashMovie.TGetProperty("/", 4);
	var nextFrame=parseInt(currentFrame);
	if (nextFrame>=10)
		nextFrame=0;
	flashMovie.GotoFrame(nextFrame);		
}


function ZoominFlashMovie()
{
	var flashMovie=getFlashMovieObject("myFlashMovie");
	flashMovie.Zoom(90);
}

function ZoomoutFlashMovie()
{
	var flashMovie=getFlashMovieObject("myFlashMovie");
	flashMovie.Zoom(110);
}


function SendDataToFlashMovie()
{
	var flashMovie=getFlashMovieObject("myFlashMovie");
	flashMovie.SetVariable("/:message", document.controller.Data.value);
}

function ReceiveDataFromFlashMovie()
{
	var flashMovie=getFlashMovieObject("myFlashMovie");
	var message=flashMovie.GetVariable("/:message");
	document.controller.Data.value=message;
}

function merda() {
	var ring = document.getElementById("myFlashMovie");
    if (!ring) {
	    var defaultColor = "#ffffff";
	    var bgcolor = defaultColor;
	    var aux = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://active.macromedia.com/flash2/cabs/swflash.cab#version=4,0,0,0" id="myFlashMovie" width="1" height="1">';
			aux += '<param name="movie" value="images/bicycle_bell.swf" />';
			aux += '<param name="quality" value=high />';
			aux += '<param name="play" value="false" />';
			aux += '<param name="bgcolor" value="#FFFFFF" />';
			aux += '<param name="loop" value="false">';
			aux += '<embed play="false" swliveconnect="true" name="myFlashMovie" src="images/bicycle_bell.swf" quality="high" bgcolor="#FFFFFF" width="1" height="1" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash">';
			aux += '</embed>';
		aux += '</object>';
	    
	    
	    var caca = document.getElementById("merda");
	    caca.innerHTML = aux;
    }
}

//-->
</script>
	</head>
	<body bgcolor="#FFFFFF" onload="merda();">
		<div id="merda"></div>
		<center>
			<!--FASTCLICK AD START-->
			<table border="1" cellpadding="0" cellspacing="0" bordercolor="#000000">
				<tr>
					<td bgcolor="#000000">
						<font color="#FFFFFF" face="Arial" size="1"><b>Advertisement</b></font>
					</td>

				</tr>
				<tr>
					<td>
						<!-- FASTCLICK.COM 728x90 and 468x60 BANNER CODE for permadi.com -->
						<script language="javascript" src="http://media.fastclick.net/w/get.media?sid=13433&m=1&tp=5&d=j&t=n"></script>
						<noscript>
							<a href="http://media.fastclick.net/w/click.here?sid=13433&m=1&c=1" target="_blank"> <img src="http://media.fastclick.net/w/get.media?sid=13433&m=1&tp=5&d=s&c=1" border=1></a>
						</noscript>
						<!-- FASTCLICK.COM 728x90 and 468x60 BANNER CODE for permadi.com -->
					</td>
				</tr>
			</table>
			<b><font color="#FFFFFF" size="1"><a class="brightlinkunderlined" href="http://www.fastclick.com/re.f?13433" target="_top">FastClick Ad Network</a> </font></b>
			<!--FASTCLICK AD END-->
		</center>

		<p>
		<div align="center">
			<table border="1" cellpadding="0" cellspacing="0" width="640" bordercolor="#000000">
				<tr>
					<td bgcolor="#0099CC">
						<p align="center">
							&nbsp;&nbsp;
							<br>
							<a href="../" class="contentbutton"><img border="0" src="../images/header_flash.gif" width="245" height="53"></a>
							<br>
							&nbsp;&nbsp;
					</td>

				</tr>
				<tr>
					<td bgcolor="#000000">
						<p align="center">
							<font color="#FFFFFF"><b>INTERACTION WITH JAVASCRIPT</b></font>
					</td>
				</tr>
				<tr>
					<td bgcolor="#FFFFFF">
						<blockquote>
							<p>
								<br>
								One of the more wonderful Flash capability is its ability to communicate with JavaScript.&nbsp; This example is intended to show various JavaScript methods (functions) that can be used to interact with a Flash movie.&nbsp;&nbsp;
							</p>

							<table border="0" width="80%" bgcolor="#FFFFCC">
								<tr>
									<td>
										<font size="2" color="#CC3300">Your browser must be JavaScript enabled to see this example.&nbsp; This tutorial has been tested on Netscape 4.7, Netscape 7, Internet Explorer 5, Internet Explorer 6, Firefox 1.04, and Opera 8, for the PC.&nbsp;
											Other browsers and Macintosh browsers might have problems running this.&nbsp; Flash 4 player or newer is required.&nbsp; This tutorial is intended for Flash 4 or better.&nbsp; &nbsp;&nbsp;&nbsp;</font><font size="2"> </font>
									</td>

								</tr>
							</table>
							<p>
								Below, you see a Flash movie, and a JavaScript controller.&nbsp; The controller buttons are all standard html <b>&lt;form&gt; </b>element.&nbsp; The buttons are associated with JavaScript function calls.&nbsp; When a button is clicked, it
								&quot;connects&quot; to the Flash movie.&nbsp; Try it and then please read on.
							</p>

							<p align="center">
								<b><font color="#0099CC">Flash Movie</font></b>
								<br>
								
							</p>
							<form name="controller" method="POST">
								<p>
								<center>
									<b><font color="#0099CC">JavaScript Controller<br> </font></b>
									<input type="button" value="Play" name="Play" onClick="PlayFlashMovie();">
									<input type="button" value="Stop" name="Stop" onClick="StopFlashMovie();">
									<input type="button" value="Rewind" name="Rewind" onClick="RewindFlashMovie();">
									<input type="button" value="NextFrame" name="NextFrame" onClick="NextFrameFlashMovie();">
									<input type="button" value="Zoomin" name="Zoomin" onClick="ZoominFlashMovie();">
									<input type="button" value="Zoomout" name="Zoomout" onClick="ZoomoutFlashMovie();">

									&nbsp;
									<br>
									Form Data:
									<input type="text" name="Data" size="20" value="Enter message">
									<input type="button" value="Send Data" name="SendData" onClick="SendDataToFlashMovie();">
									<input type="button" value="Receive Data" name="ReceiveData" onClick="ReceiveDataFromFlashMovie();">
									<br>
								</center>
								</p>
								<p>
									&nbsp;

								</p>
							</form>

						</blockquote>
					</td>
				</tr>
				<tr>
					<td bgcolor="#000000">
						<p align="center">
							<b><font color="#FFFFFF">How It Works</font></b>
					</td>
				</tr>
				<tr>
					<td bgcolor="#FFFFFF">
						<blockquote>

							<p>
								<br>
								Within the html page, a Flash movie is just an &quot;object,&quot;&nbsp;much like a window, a form elements, or an image.&nbsp; (In Internet Exporer (IE), a Flash object as actually an COM object or an ActiveX object.)&nbsp; Read more about it
								here.&nbsp; The Flash movie object can be referenced several ways depending to the browsers.&nbsp;&nbsp;
							</p>
							<pre>
								<font color="#800000">window.document[movieName]      // (on Mozilla browsers such as Netscape)
window[movieName]               // (on Internet Explorer as of ver 5)
document.embeds[movieName]      // Mozilla Netscape, Firefox or Opera</font>
							</pre>
							<p>
								Here's a function that retrieves the Flash movie.&nbsp; Ideally, it should not be this complicated, but if you're having problems, first check <a href="../flashGetObject" class="contentlink">this other tutorial</a>.
							</p>
							<table border="0" width="80%" bgcolor="#FFFFCC">
								<tr>
									<td width="80">
										<table border="0" width="80%" bgcolor="#FFFFCC">
											<tr>
												<td width="80">
													<pre>function getFlashMovieObject(movieName)
{
  if (window.document[movieName]) 
  {
      return window.document[movieName];
  }
  if (navigator.appName.indexOf(&quot;Microsoft Internet&quot;)==-1)
  {
    if (<font color="#000000">document.embeds &amp;&amp; document.embeds[</font>movieName<font color="#000000">])
      return document.embeds[</font>movieName<font color="#000000">]; </font>

  }
  else // if (navigator.appName.indexOf(&quot;Microsoft Internet&quot;)!=-1)
  {
    return document.getElementById(movieName);
  }
}</pre>
												</td>
											</tr>
										</table>
									</td>
								</tr>
							</table>
							<p>
								&nbsp;
							</p>
							<table border="0" width="80%">

								<tr>
									<td valign="top" width="190">
										<table border="1" bordercolor="#000000" cellspacing="0" cellpadding="0">
											<tr>
												<table border="0" bgcolor="#FFFFCC">
													<tr>
														<td>
															<font color="#000000" size="2">Most modern browsers support using <b>getElementById(movieName)</b>.&nbsp; While this can be used to retrieve the Flash movie on Internet Explorer; on other browsers (such as Opera or Firefox), it does not work
																as expected.&nbsp; The reason is because those browsers need to use the element in the &lt;embed&gt; tag, whereas <b>getElementById</b> will retrieve the element in the &lt;object&gt; tag.&nbsp; </font>
														</td>

													</tr>
												</table>
												</td>
												<td valign="top" width="50">
													&nbsp;
												</td>
												<td width="245">
													<Table cellspacing="0" cellpadding="0">
														<td bgcolor="#000000">
															<font color="#FFFFFF" size="1">Advertisement</font>
														</td>
														</tr>
														<tr>

															<td>
																<!-- FASTCLICK.COM 300x250 Medium Rectangle CODE for permadi.com -->
																<script language="javascript" src="http://media.fastclick.net/w/get.media?sid=13433&m=6&tp=8&d=j&t=s"></script>
																<noscript>
																	<a href="http://media.fastclick.net/w/click.here?sid=13433&m=6&c=1" target="_top"> <img src="http://media.fastclick.net/w/get.media?sid=13433&m=6&tp=8&d=s&c=1" width=300 height=250 border=1></a>
																</noscript>
																<!-- FASTCLICK.COM 300x250 Medium Rectangle CODE for permadi.com -->
															</td>
														</tr>
														<tr>
															<td bgcolor="#A60000">
																<!-- FASTCLICK.COM REFERRAL BUTTON [permadi.com] -->
																<!-- FASTCLICK.COM REFERRAL LINK [permadi.com] -->
																<font color="#FFFFFF" size="2"><a class="brightlinkunderlined" href="http://www.fastclick.com/re.f?13433" target="_top"> <font size="1">FastClick Ad Network</font></a><b> </b> </font>
																<!-- FASTCLICK.COM REFERRAL LINK [permadi.com] -->
																<br>
															</td>
														</tr>
													</table>


												</td>
											</tr>
										</table>
										<p>
											Associated with the Flash movie object, are several predefined functions (methods) that can be used to &quot;connect&quot; or communicate with the movie.&nbsp; These methods can be called from within scripting languages such as JavaScript or
											VBScript.&nbsp;&nbsp;
										</p>

										<p>
											Far from just being able to control the playback of the movie, Flash also provides methods that can be used to send and receive data from the Flash movie.&nbsp; So, a html page can send and receive data from a Flash movie.&nbsp; To see this
											capability:
											<br>
											<b>Receiving data from a Flash movie:</b>
											<br>
											- Enter some text in the Flash movie's <b>Data</b> field, then press <b>Receive Data</b>.&nbsp; The data from the Flash movie is then transferred to the html form.
											<br>

											<b>Sending data to a Flash movie:</b>
											<br>
											- Enter some text in the html <b>Form Data</b> field, then press <b>Send Data</b>.&nbsp; The data from the html form field is then transferred to the Flash movie.
										</p>
										<p>
											In the above example, JavaScript is used to create the interface for the Controller panel.&nbsp; The Controller panel itself consists of standard html <b>&lt;form&gt;</b> buttons; and each button has an &quot;<b>onClick()</b>&quot; method.&nbsp;
											(Note: onClick() is a JavaScript method.)&nbsp; The &quot;onClick()&quot; event is associated with a function call, which in turns will call one or more Flash methods.&nbsp;&nbsp; Below are the list of the Flash methods used in this example:

										</p>
										<ul>
											<li>
												Play Button
												<br>
												Flash method being used: <b>Play()</b>
											</li>
											<li>
												Stop Button
												<br>
												Flash method being used: <b>StopPlay()</b>
											</li>
											<li>
												Rewind Button
												<br>

												Flash method being used: <b>Rewind()</b>
											</li>
											<li>
												NextFrame Button
												<br>
												Flash method being used: <b>TGetProperty(nameOfTargetMovieClip, propertyIndex) </b>and<b> GotoFrame(frameNum)</b>
											</li>

											<li>
												Zoomin Button &amp; Zoomout Button
												<br>
												Flash method being used: <b>Zoom(relative percentage)</b>
											</li>
											<li>
												Send Data
												<br>
												Flash method being used: <b>SetVariable(variableName, variableValue)</b>
											</li>

											<li>
												Receive Data<b><br> </b>Flash method being used: <b>GetVariable(variableName)</b>
											</li>
										</ul>
										<font color="#000000">For example, the <b>Send Data</b> button is calling a user defined JavaScript function named <b>sendDataToFlashMovie()</b>.&nbsp; This function is shown below and it can be viewed by viewing the source of this html
											page.&nbsp; This function when called, will in turn call the <b>SetVariable()</b> method of the Flash movie object:</font>
										<pre>
											<font color="#0000FF">function SendDataToFlashMovie()
{
     var flashMovie=getFlashMovieObject(&quot;myFlashMovie&quot;);
     flashMovie.SetVariable(&quot;/:message&quot;, 
          document.controller.Data.value);
}</font>
										</pre>
										<p>
											<font color="#000000">This function obtain the Flash movie object by calling <b>getFlashMovieObject(&quot;myFlashMovie&quot;)</b>.<b> </b> Note that <b>&quot;myFlashMovie&quot;</b> is the <b>id</b> and the <b>name</b> that I assigned to the
												Flash movie (as shown below).&nbsp;&nbsp; </font>
										</p>

										<p>
											<font color="#000000"><b>SendDataToFlashMovie()</b></font><font color="#0000FF"> </font> <font color="#000000">then sets a variable in the Flash movie called &quot;<b>message</b>&quot; located in the movie's main scene timeline.&nbsp; The value
												of the variable is obtained from Form Data.&nbsp; The Form Data is a <b>&lt;textarea&gt;</b> named &quot;Data&quot;.&nbsp; The &lt;form&gt; itself is named &quot;controller&quot;.&nbsp; So the object &quot;document.controller.Data.value&quot;
												refers to the value of the Form Data &lt;textarea&gt;.&nbsp; Examine the <b>&lt;form&gt; </b>portion of this html page's source to see more detail.</font>
										</p>
										<p>
											<font color="#000000"><b>EMBED and OBJECT tag requirement<br> </b>Both &lt;embed&gt; and &lt;object&gt; actually does the same thing, but most people use both because one is only recognized by Mozilla browsers (Netscape, Firefox), and the other
												only by Internet Explorer.&nbsp; Internet Explorer browsers uses &lt;object&gt; tag; Mozilla browsers (such as Netscape and Firefox) use &lt;embed&gt; tag.&nbsp; </font>
										</p>

										<p>
											<font color="#000000">To enable communication with JavaScript, below are some additional requirement for each tag.&nbsp; First, though, and example of how a Flash movie is inserted on a html page.</font>
										</p>
										<pre>
											<font color="#0000FF">&lt;object classid=&quot;clsid:D27CDB6E-AE6D-11cf-96B8-444553540000&quot;
codebase=&quot;&quot; </font><b><font color="#CC0000">id=&quot;myFlashMovie&quot;</font></b><font color="#0000FF"> width=481 height=86&gt;
&lt;param name=movie value=&quot;flips2.swf&quot;&gt;

&lt;embed play=false </font><font color="#CC0000"><b>swliveconnect=&quot;true&quot;</b> <b>name=&quot;</b></font><b><font color="#CC0000">myFlashMovie</font></b><font color="#FF6464">&quot;</font><font color="#0000FF"> 
src=&quot;flips2.swf&quot; quality=high bgcolor=#FFFFFF</font> <font color="#0000FF">
width=481 height=86 type=&quot;application/x-shockwave-flash&quot; 
....&gt;

&lt;/embed &gt;
&lt;/object &gt;</font>
										</pre>
										<p>
											<font color="#000000">In this example, the Flash movie name and id is &quot;<b>myFlashMovie</b>&quot;.&nbsp; (This name is arbitrary.&nbsp; It is recommended to use the same value for both the <b>id</b> and <b>name</b> within the same Flash
												movie; but you must make sure that no <i>other</i> element uses the same name and id.<b>&nbsp; </b>Also, use alphanumeric characters only, and do not start with a number.)&nbsp;&nbsp;&nbsp; Here're some requirements to make them scriptable.</font>
										</p>
										<p>
											<font color="#000000"><b>The &lt;object&gt; tag:</b><br> - the Flash movie must have an <b>id</b>.&nbsp; For example, in this the example above, the <b>id</b> is set by <b>id=&quot;myFlashMovie&quot;<br> <br> The &lt;embed&gt; tag:<br> </b>- the
												Flash movie must have a <b>name</b>.&nbsp; For example, in the example above, the <b>name</b> is set by <b>name=&quot;myFlashMovie&quot;<br> </b>- the &lt;embed&gt; tag must include <b>swliveconnect=&quot;true&quot;</b> attribute, to turn-on
												the ability to &quot;connect&quot; with the scripting language (JavaScript).</font>
										</p>
										<p>
											<font color="#000000">It is recommended to use the same value for that both the <b>id</b> and <b>name</b> within the same Flash movie.</font>
										</p>

										</blockquote>
									</td>
								</tr>
								<tr>
									<td bgcolor="#000000">
										<p align="center">
											<b><font color="#FFFFFF">Further Reference</font></b>
									</td>
  </tr>
  <tr> 
    <td bgcolor="#FFFFFF"> 
      <blockquote>

<p>&nbsp;</p>
<ul>
	<li>These are just some of the examples of the available Flash methods that can be used to control a Flash
movie.&nbsp; For a complete list, consult:
the <a class="contentlink" href="http://www.macromedia.com/support/flash/publishexport/scriptingwithflash4/scriptingwithflash4_03.html">Macromedia
reference</a>.<br>
&nbsp; </li>
	<li>If you're having problems, I suggest reading the tutorial about
	<a href="../flashGetObject/index.html" class="contentlink">Referencing Flash 
	Movie Object</a> elsewhere on this site. </li>

</ul>
      </blockquote>
      <p align="center">
<b><font color="#CC0000">&lt;&lt;</font></b><font face="Arial" color="#0099CC"><b><a CLASS="backbutton" HREF="../index.html">INDEX</a></b></font><b><font color="#CC0000">&gt;&gt;<br>
</font></b>
      <p align="center">(C) 2000 F. Permadi<br>
        May 2000</p>
<p align="center"><font face="Arial"><a class="darklink" href="mailto:permadi@permadi.com">permadi@permadi.com
</a></font>
      </p>

<p align="center"><font face="Arial" size="2"><A CLASS="contentlink" HREF="../termofuse/index.html">Terms
        of Use<br>
                    </a>
&nbsp;&nbsp;
        </font><font face="Arial"><a class="darklink" href="mailto:permadi@permadi.com"><br>
</a></font><b><font color="#CC0000">&nbsp;
</font></b>
      </p>
      </td>
  </tr>
</table>
</div>

<p>

</BODY>
</HTML>
